<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "admin">
	
	<!-- 카테고리 호출 -->
	<select id="category" resultType="com.example.spring03.domain.CategoryVO">
		select level, catename, catecode, catecoderef from goods_category
		start with catecoderef is null connect by prior catecode = catecoderef
	</select>
	
	<!-- 상품 등록 -->
	<insert id="register" parameterType="com.example.spring03.domain.GoodsVO">
		insert into tbl_goods (gdsnum, gdsname, catecode, gdsprice, gdsstock, gdsdes, gdsimg, gdsthumbimg)
		values (tbl_goods_seq.nextval, #{gdsname}, #{catecode}, #{gdsprice}, #{gdsstock}, #{gdsdes}, #{gdsimg}, #{gdsthumbimg})
	</insert>
	
	<!-- 상품 리스트 -->
<!-- 	<select id="goodsList" resultType="com.example.spring03.domain.GoodsVO">
		select gdsnum, gdsname, catecode, gdsprice, gdsstock, gdsdes, gdsimg, gdsdate from tbl_goods order by gdsnum desc
	</select> -->
	
	<select id="goodsList" resultType="com.example.spring03.domain.GoodsViewVO">
		select g.gdsnum, g.gdsname, g.catecode, c.catecoderef, c.catename, g.gdsprice, g.gdsstock, g.gdsdes, g.gdsdate, g.gdsimg, g.gdsthumbimg
		from tbl_goods g inner join goods_category c on g.catecode = c.catecode order by gdsnum desc
	</select>
	
	<!-- 상품 조회 -->
<!-- 	<select id="goodsView" resultType="com.example.spring03.domain.GoodsVO">
		select gdsnum, gdsname, catecode, gdsprice, gdsstock, gdsdes, gdsimg, gdsdate from tbl_goods where gdsnum = #{gdsnum}
	</select> -->
	
	<!-- 상품 조회 + 카테고리 조인 -->
	<select id="goodsView" resultType="com.example.spring03.domain.GoodsViewVO">
		select g.gdsnum, g.gdsname, g.catecode, c.catecoderef, c.catename, g.gdsprice, g.gdsstock, g.gdsdes, g.gdsdate, g.gdsimg, g.gdsthumbimg from tbl_goods g
		inner join goods_category c on g.catecode = c.catecode where g.gdsnum = #{gdsnum}
	</select>
	
	<!-- 상품 수정 -->
	<update id="goodsModify" parameterType="com.example.spring03.domain.GoodsVO">
		update tbl_goods set gdsname = #{gdsname}, catecode = #{catecode}, gdsprice = #{gdsprice}, gdsstock = #{gdsstock}, gdsdes = #{gdsdes}, gdsimg = #{gdsimg}, gdsthumbimg = #{gdsthumbimg}
		where gdsnum = #{gdsnum}
	</update>
	
	<!-- 상품 삭제 -->
	<delete id="goodsDelete" parameterType="int">
		delete tbl_goods where gdsnum = #{gdsnum}
	</delete>
	
</mapper>